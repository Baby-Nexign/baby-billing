{"uid":"6da3a926dd4e4f65","name":"Тест: BRT не сохраняет CDR, если оба абонента внешние","fullName":"tests.test_external_calls#test_process_cdr_file_with_only_external_numbers","historyId":"e9d8b21a339f9bde40ffec1e871931f0","time":{"start":1746967599950,"stop":1746967604985,"duration":5035},"description":"Проверяет, что файл CDR, содержащий только звонки между внешними (неизвестными BRT) номерами, не приводит к созданию записей в БД. Используется файл: test_data/all_external_cdr.jsonl.","descriptionHtml":"<p>Проверяет, что файл CDR, содержащий только звонки между внешними (неизвестными BRT) номерами, не приводит к созданию записей в БД. Используется файл: test_data/all_external_cdr.jsonl.</p>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"db_connection","time":{"start":1746967599914,"stop":1746967599950,"duration":36},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Проверяет, что файл CDR, содержащий только звонки между внешними (неизвестными BRT) номерами, не приводит к созданию записей в БД. Используется файл: test_data/all_external_cdr.jsonl.","status":"passed","steps":[{"name":"1. Подготовка БД: очистка cdr_record и проверка наличия 'внутренних' абонентов (['79123456789', '79996667755', '79334455667'])","time":{"start":1746967599950,"stop":1746967599964,"duration":14},"status":"passed","steps":[],"attachments":[{"uid":"18366dd0a126a1f8","name":"ID подготовленных/проверенных 'внутренних' абонентов","source":"18366dd0a126a1f8.json","type":"application/json","size":62}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"2. Чтение CDR (только внешние номера) из файла: test_data/all_external_cdr.jsonl","time":{"start":1746967599964,"stop":1746967599965,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"1bb7308c06e43521","name":"Содержимое файла test_data/all_external_cdr.jsonl (внешние номера)","source":"1bb7308c06e43521.json","type":"application/json","size":1972},{"uid":"54dbcc7066fa9d78","name":"Информация о прочитанном файле","source":"54dbcc7066fa9d78.txt","type":"text/plain","size":105}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"3. Отправка 10 CDR (внешние номера) в RabbitMQ","time":{"start":1746967599966,"stop":1746967599977,"duration":11},"status":"passed","steps":[],"attachments":[{"uid":"f74b7bc14cf6b0d6","name":"CDRы (внешние номера), отправленные в RabbitMQ","source":"f74b7bc14cf6b0d6.json","type":"application/json","size":1972}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"4. Ожидание 5 секунд для обработки CDR сервисом BRT","time":{"start":1746967599977,"stop":1746967604978,"duration":5001},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"5. Проверка отсутствия записей в таблице cdr_record (ожидается: 0)","time":{"start":1746967604978,"stop":1746967604984,"duration":6},"status":"passed","steps":[],"attachments":[{"uid":"d8ffcc2ee089c677","name":"Сводка по записям в БД","source":"d8ffcc2ee089c677.txt","type":"text/plain","size":90}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"ae0d5cd7dfe4c167","name":"Ожидаемое количество записей в БД после обработки","source":"ae0d5cd7dfe4c167.txt","type":"text/plain","size":1},{"uid":"d5a1f4b466dc1287","name":"log","source":"d5a1f4b466dc1287.txt","type":"text/plain","size":5284},{"uid":"acc72d51b1b1a774","name":"stderr","source":"acc72d51b1b1a774.txt","type":"text/plain","size":5114}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":5,"attachmentsCount":8,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"db_connection::0","time":{"start":1746967604987,"stop":1746967604990,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"story","value":"Игнорирование CDR между исключительно внешними номерами"},{"name":"epic","value":"Обработка CDR в BRT"},{"name":"severity","value":"normal"},{"name":"feature","value":"Бизнес-логика - Обработка вызовов"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_external_calls"},{"name":"host","value":"imenov"},{"name":"thread","value":"32580-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_external_calls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"tags":[]},"source":"6da3a926dd4e4f65.json","parameterValues":[]}