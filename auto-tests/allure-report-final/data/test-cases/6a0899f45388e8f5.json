{"uid":"6a0899f45388e8f5","name":"Проверка списания минут из пакета (ТП 'Помесячный') без изменения денежного баланса","fullName":"tests.test_e2e_monthly_01#test_e2e_monthly_01_package_minutes_deduction","historyId":"8a17a6908a342dc186052b0bd67a4e75","time":{"start":1746919835916,"stop":1746919840968,"duration":5052},"description":"\n    Тест проверяет, что при исходящем звонке абонента с тарифным планом 'Помесячный':\n    1. Минуты корректно списываются из предоплаченного пакета.\n    2. Денежный баланс абонента не изменяется, если длительность звонка не превышает остаток минут в пакете.\n    Шаги:\n    1. Создание/обновление данных абонента с начальным пакетом минут и денежным балансом.\n    2. Отправка CDR о звонке в RabbitMQ.\n    3. Расчет ожидаемого остатка минут в пакете после звонка.\n    4. Проверка фактического остатка минут в пакете.\n    5. Проверка неизменности денежного баланса абонента.\n","descriptionHtml":"<pre><code>Тест проверяет, что при исходящем звонке абонента с тарифным планом 'Помесячный':\n1. Минуты корректно списываются из предоплаченного пакета.\n2. Денежный баланс абонента не изменяется, если длительность звонка не превышает остаток минут в пакете.\nШаги:\n1. Создание/обновление данных абонента с начальным пакетом минут и денежным балансом.\n2. Отправка CDR о звонке в RabbitMQ.\n3. Расчет ожидаемого остатка минут в пакете после звонка.\n4. Проверка фактического остатка минут в пакете.\n5. Проверка неизменности денежного баланса абонента.\n</code></pre>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"reset_sequences_after_migrations","time":{"start":1746919820654,"stop":1746919820676,"duration":22},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"db_connection","time":{"start":1746919835902,"stop":1746919835916,"duration":14},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n    Тест проверяет, что при исходящем звонке абонента с тарифным планом 'Помесячный':\n    1. Минуты корректно списываются из предоплаченного пакета.\n    2. Денежный баланс абонента не изменяется, если длительность звонка не превышает остаток минут в пакете.\n    Шаги:\n    1. Создание/обновление данных абонента с начальным пакетом минут и денежным балансом.\n    2. Отправка CDR о звонке в RabbitMQ.\n    3. Расчет ожидаемого остатка минут в пакете после звонка.\n    4. Проверка фактического остатка минут в пакете.\n    5. Проверка неизменности денежного баланса абонента.\n","status":"passed","steps":[{"name":"1. Подготовка данных абонента с пакетом минут","time":{"start":1746919835916,"stop":1746919835941,"duration":25},"status":"passed","steps":[],"attachments":[{"uid":"69d32f790050a802","name":"Данные абонента (вход)","source":"69d32f790050a802.json","type":"application/json","size":205},{"uid":"9219303f4ff556d","name":"ID созданного/обновленного абонента","source":"9219303f4ff556d.txt","type":"text/plain","size":22}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"2. Отправка CDR: 79222222229 -> 79888888889, Начало: 2025-05-01T13:00:00, Конец: 2025-05-01T13:05:30","time":{"start":1746919835941,"stop":1746919835956,"duration":15},"status":"passed","steps":[],"attachments":[{"uid":"314dcfa0f7dadb51","name":"Отправляемый CDR","source":"314dcfa0f7dadb51.json","type":"application/json","size":171}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"3. Расчет биллинговых минут и ожидаемого остатка в пакете","time":{"start":1746919835957,"stop":1746919835957,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"be789efd5c713bf6","name":"Расчет биллинговых минут","source":"be789efd5c713bf6.txt","type":"text/plain","size":56},{"uid":"d4ee1383287eede2","name":"Расчет остатка пакетных минут","source":"d4ee1383287eede2.txt","type":"text/plain","size":122}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Пауза 5 сек. для обработки биллинга","time":{"start":1746919835957,"stop":1746919840958,"duration":5001},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"4. Проверка остатка пакетных минут для абонента 79222222229 (ID: 6)","time":{"start":1746919840958,"stop":1746919840964,"duration":6},"status":"passed","steps":[],"attachments":[{"uid":"876c214c6dee9aaf","name":"Детали пакетных минут 79222222229","source":"876c214c6dee9aaf.txt","type":"text/plain","size":71}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"5. Проверка денежного баланса абонента 79222222229 (не должен измениться)","time":{"start":1746919840964,"stop":1746919840967,"duration":3},"status":"passed","steps":[],"attachments":[{"uid":"2a0bbcaffadc89f3","name":"Детали денежного баланса 79222222229","source":"2a0bbcaffadc89f3.txt","type":"text/plain","size":154}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"82dba75c7ed386b0","name":"log","source":"82dba75c7ed386b0.txt","type":"text/plain","size":1285},{"uid":"e93fa06bf3f3a2fa","name":"stderr","source":"e93fa06bf3f3a2fa.txt","type":"text/plain","size":1267}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":9,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"db_connection::0","time":{"start":1746919840970,"stop":1746919840973,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"story","value":"E2E-MONTHLY-01: Исходящий звонок в пределах пакета минут"},{"name":"severity","value":"critical"},{"name":"feature","value":"Тариф 'Помесячный'"},{"name":"epic","value":"Биллинг"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_e2e_monthly_01"},{"name":"host","value":"imenov"},{"name":"thread","value":"330609-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_e2e_monthly_01"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[],"tags":[]},"source":"6a0899f45388e8f5.json","parameterValues":[]}